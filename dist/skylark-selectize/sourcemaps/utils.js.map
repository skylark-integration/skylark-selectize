{"version":3,"sources":["utils.js"],"names":["define","$","constants","$testInput","hook","before","self","method","fn","original","apply","arguments","after","result","getSelection","input","start","selectionStart","length","selectionEnd","document","selection","focus","sel","createRange","selLen","text","moveStart","value","transferStyles","$from","$to","properties","i","n","styles","css","measureString","str","$parent","position","top","left","width","padding","whiteSpace","appendTo","isset","object","hash_key","escape_html","replace","escape_replace","once","called","this","debounce","delay","timeout","args","window","clearTimeout","setTimeout","debounce_events","types","type","trigger","event_args","indexOf","hasOwnProperty","watchChildEvent","event","selector","on","e","child","target","parentNode","currentTarget","autoGrow","$input","currentWidth","update","options","keyCode","printable","placeholder","shift","character","metaKey","altKey","force","data","val","toLowerCase","KEY_DELETE","KEY_BACKSPACE","substring","shiftKey","String","fromCharCode","toUpperCase","attr","triggerHandler","domToString","d","tmp","createElement","appendChild","cloneNode","innerHTML","logError","message","console","error","component","explanation","group","groupEnd"],"mappings":"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","file":"../utils.js","sourcesContent":["define([\n\t\"skylark-jquery\",\n\t\"./constants\"\t\n],function($,constants) {\n\t/**\n\t * Determines if the provided value has been defined.\n\t *\n\t * @param {mixed} object\n\t * @returns {boolean}\n\t */\n\tvar isset = function(object) {\n\t\treturn typeof object !== 'undefined';\n\t};\n\n\t/**\n\t * Converts a scalar to its best string representation\n\t * for hash keys and HTML attribute values.\n\t *\n\t * Transformations:\n\t *   'str'     -> 'str'\n\t *   null      -> ''\n\t *   undefined -> ''\n\t *   true      -> '1'\n\t *   false     -> '0'\n\t *   0         -> '0'\n\t *   1         -> '1'\n\t *\n\t * @param {string} value\n\t * @returns {string|null}\n\t */\n\tvar hash_key = function(value) {\n\t\tif (typeof value === 'undefined' || value === null) return null;\n\t\tif (typeof value === 'boolean') return value ? '1' : '0';\n\t\treturn value + '';\n\t};\n\n\t/**\n\t * Escapes a string for use within HTML.\n\t *\n\t * @param {string} str\n\t * @returns {string}\n\t */\n\tvar escape_html = function(str) {\n\t\treturn (str + '')\n\t\t\t.replace(/&/g, '&amp;')\n\t\t\t.replace(/</g, '&lt;')\n\t\t\t.replace(/>/g, '&gt;')\n\t\t\t.replace(/\"/g, '&quot;');\n\t};\n\n\t/**\n\t * Escapes \"$\" characters in replacement strings.\n\t *\n\t * @param {string} str\n\t * @returns {string}\n\t */\n\tvar escape_replace = function(str) {\n\t\treturn (str + '').replace(/\\$/g, '$$$$');\n\t};\n\n\tvar hook = {};\n\n\t/**\n\t * Wraps `method` on `self` so that `fn`\n\t * is invoked before the original method.\n\t *\n\t * @param {object} self\n\t * @param {string} method\n\t * @param {function} fn\n\t */\n\thook.before = function(self, method, fn) {\n\t\tvar original = self[method];\n\t\tself[method] = function() {\n\t\t\tfn.apply(self, arguments);\n\t\t\treturn original.apply(self, arguments);\n\t\t};\n\t};\n\n\t/**\n\t * Wraps `method` on `self` so that `fn`\n\t * is invoked after the original method.\n\t *\n\t * @param {object} self\n\t * @param {string} method\n\t * @param {function} fn\n\t */\n\thook.after = function(self, method, fn) {\n\t\tvar original = self[method];\n\t\tself[method] = function() {\n\t\t\tvar result = original.apply(self, arguments);\n\t\t\tfn.apply(self, arguments);\n\t\t\treturn result;\n\t\t};\n\t};\n\n\t/**\n\t * Wraps `fn` so that it can only be invoked once.\n\t *\n\t * @param {function} fn\n\t * @returns {function}\n\t */\n\tvar once = function(fn) {\n\t\tvar called = false;\n\t\treturn function() {\n\t\t\tif (called) return;\n\t\t\tcalled = true;\n\t\t\tfn.apply(this, arguments);\n\t\t};\n\t};\n\n\t/**\n\t * Wraps `fn` so that it can only be called once\n\t * every `delay` milliseconds (invoked on the falling edge).\n\t *\n\t * @param {function} fn\n\t * @param {int} delay\n\t * @returns {function}\n\t */\n\tvar debounce = function(fn, delay) {\n\t\tvar timeout;\n\t\treturn function() {\n\t\t\tvar self = this;\n\t\t\tvar args = arguments;\n\t\t\twindow.clearTimeout(timeout);\n\t\t\ttimeout = window.setTimeout(function() {\n\t\t\t\tfn.apply(self, args);\n\t\t\t}, delay);\n\t\t};\n\t};\n\n\t/**\n\t * Debounce all fired events types listed in `types`\n\t * while executing the provided `fn`.\n\t *\n\t * @param {object} self\n\t * @param {array} types\n\t * @param {function} fn\n\t */\n\tvar debounce_events = function(self, types, fn) {\n\t\tvar type;\n\t\tvar trigger = self.trigger;\n\t\tvar event_args = {};\n\n\t\t// override trigger method\n\t\tself.trigger = function() {\n\t\t\tvar type = arguments[0];\n\t\t\tif (types.indexOf(type) !== -1) {\n\t\t\t\tevent_args[type] = arguments;\n\t\t\t} else {\n\t\t\t\treturn trigger.apply(self, arguments);\n\t\t\t}\n\t\t};\n\n\t\t// invoke provided function\n\t\tfn.apply(self, []);\n\t\tself.trigger = trigger;\n\n\t\t// trigger queued events\n\t\tfor (type in event_args) {\n\t\t\tif (event_args.hasOwnProperty(type)) {\n\t\t\t\ttrigger.apply(self, event_args[type]);\n\t\t\t}\n\t\t}\n\t};\n\n\t/**\n\t * A workaround for http://bugs.jquery.com/ticket/6696\n\t *\n\t * @param {object} $parent - Parent element to listen on.\n\t * @param {string} event - Event name.\n\t * @param {string} selector - Descendant selector to filter by.\n\t * @param {function} fn - Event handler.\n\t */\n\tvar watchChildEvent = function($parent, event, selector, fn) {\n\t\t$parent.on(event, selector, function(e) {\n\t\t\tvar child = e.target;\n\t\t\twhile (child && child.parentNode !== $parent[0]) {\n\t\t\t\tchild = child.parentNode;\n\t\t\t}\n\t\t\te.currentTarget = child;\n\t\t\treturn fn.apply(this, [e]);\n\t\t});\n\t};\n\n\t/**\n\t * Determines the current selection within a text input control.\n\t * Returns an object containing:\n\t *   - start\n\t *   - length\n\t *\n\t * @param {object} input\n\t * @returns {object}\n\t */\n\tvar getSelection = function(input) {\n\t\tvar result = {};\n\t\tif ('selectionStart' in input) {\n\t\t\tresult.start = input.selectionStart;\n\t\t\tresult.length = input.selectionEnd - result.start;\n\t\t} else if (document.selection) {\n\t\t\tinput.focus();\n\t\t\tvar sel = document.selection.createRange();\n\t\t\tvar selLen = document.selection.createRange().text.length;\n\t\t\tsel.moveStart('character', -input.value.length);\n\t\t\tresult.start = sel.text.length - selLen;\n\t\t\tresult.length = selLen;\n\t\t}\n\t\treturn result;\n\t};\n\n\t/**\n\t * Copies CSS properties from one element to another.\n\t *\n\t * @param {object} $from\n\t * @param {object} $to\n\t * @param {array} properties\n\t */\n\tvar transferStyles = function($from, $to, properties) {\n\t\tvar i, n, styles = {};\n\t\tif (properties) {\n\t\t\tfor (i = 0, n = properties.length; i < n; i++) {\n\t\t\t\tstyles[properties[i]] = $from.css(properties[i]);\n\t\t\t}\n\t\t} else {\n\t\t\tstyles = $from.css();\n\t\t}\n\t\t$to.css(styles);\n\t};\n\n\tvar $testInput;\n\t/**\n\t * Measures the width of a string within a\n\t * parent element (in pixels).\n\t *\n\t * @param {string} str\n\t * @param {object} $parent\n\t * @returns {int}\n\t */\n\tvar measureString = function(str, $parent) {\n\t\tif (!str) {\n\t\t\treturn 0;\n\t\t}\n\n\t\tif (!$testInput) {\n\t\t\t$testInput = $('<span />').css({\n\t\t\t\tposition: 'absolute',\n\t\t\t\ttop: -99999,\n\t\t\t\tleft: -99999,\n\t\t\t\twidth: 'auto',\n\t\t\t\tpadding: 0,\n\t\t\t\twhiteSpace: 'pre'\n\t\t\t}).appendTo('body');\n\t\t}\n\n\t\t$testInput.text(str);\n\n\t\ttransferStyles($parent, $testInput, [\n\t\t\t'letterSpacing',\n\t\t\t'fontSize',\n\t\t\t'fontFamily',\n\t\t\t'fontWeight',\n\t\t\t'textTransform'\n\t\t]);\n\n\t\treturn $testInput.width();\n\t};\n\n\t/**\n\t * Sets up an input to grow horizontally as the user\n\t * types. If the value is changed manually, you can\n\t * trigger the \"update\" handler to resize:\n\t *\n\t * $input.trigger('update');\n\t *\n\t * @param {object} $input\n\t */\n\tvar autoGrow = function($input) {\n\t\tvar currentWidth = null;\n\n\t\tvar update = function(e, options) {\n\t\t\tvar value, keyCode, printable, placeholder, width;\n\t\t\tvar shift, character, selection;\n\t\t\te = e || window.event || {};\n\t\t\toptions = options || {};\n\n\t\t\tif (e.metaKey || e.altKey) return;\n\t\t\tif (!options.force && $input.data('grow') === false) return;\n\n\t\t\tvalue = $input.val();\n\t\t\tif (e.type && e.type.toLowerCase() === 'keydown') {\n\t\t\t\tkeyCode = e.keyCode;\n\t\t\t\tprintable = (\n\t\t\t\t\t(keyCode >= 48 && keyCode <= 57)  || // 0-9\n\t\t\t\t\t(keyCode >= 65 && keyCode <= 90)   || // a-z\n\t\t\t\t\t(keyCode >= 96 && keyCode <= 111)  || // numpad 0-9, numeric operators\n\t\t\t\t\t(keyCode >= 186 && keyCode <= 222) || // semicolon, equal, comma, dash, etc.\n\t\t\t\t\tkeyCode === 32 // space\n\t\t\t\t);\n\n\t\t\t\tif (keyCode === constants.KEY_DELETE || keyCode === constants.KEY_BACKSPACE) {\n\t\t\t\t\tselection = getSelection($input[0]);\n\t\t\t\t\tif (selection.length) {\n\t\t\t\t\t\tvalue = value.substring(0, selection.start) + value.substring(selection.start + selection.length);\n\t\t\t\t\t} else if (keyCode === constants.KEY_BACKSPACE && selection.start) {\n\t\t\t\t\t\tvalue = value.substring(0, selection.start - 1) + value.substring(selection.start + 1);\n\t\t\t\t\t} else if (keyCode === constants.KEY_DELETE && typeof selection.start !== 'undefined') {\n\t\t\t\t\t\tvalue = value.substring(0, selection.start) + value.substring(selection.start + 1);\n\t\t\t\t\t}\n\t\t\t\t} else if (printable) {\n\t\t\t\t\tshift = e.shiftKey;\n\t\t\t\t\tcharacter = String.fromCharCode(e.keyCode);\n\t\t\t\t\tif (shift) character = character.toUpperCase();\n\t\t\t\t\telse character = character.toLowerCase();\n\t\t\t\t\tvalue += character;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tplaceholder = $input.attr('placeholder');\n\t\t\tif (!value && placeholder) {\n\t\t\t\tvalue = placeholder;\n\t\t\t}\n\n\t\t\twidth = measureString(value, $input) + 4;\n\t\t\tif (width !== currentWidth) {\n\t\t\t\tcurrentWidth = width;\n\t\t\t\t$input.width(width);\n\t\t\t\t$input.triggerHandler('resize');\n\t\t\t}\n\t\t};\n\n\t\t$input.on('keydown keyup update blur', update);\n\t\tupdate();\n\t};\n\n\tvar domToString = function(d) {\n\t\tvar tmp = document.createElement('div');\n\n\t\ttmp.appendChild(d.cloneNode(true));\n\n\t\treturn tmp.innerHTML;\n\t};\n\n\tvar logError = function(message, options){\n\t\tif(!options) options = {};\n\t\tvar component = \"Selectize\";\n\n\t\tconsole.error(component + \": \" + message)\n\n\t\tif(options.explanation){\n\t\t\t// console.group is undefined in <IE11\n\t\t\tif(console.group) console.group();\n\t\t\tconsole.error(options.explanation);\n\t\t\tif(console.group) console.groupEnd();\n\t\t}\n\t};\n\n\treturn {\n\t\tisset,\n\t\thash_key,\n\t\tescape_html,\n\t\tescape_replace,\n\t\thook,\n\t\tonce,\n\t\tdebounce,\n\t\tdebounce_events,\n\t\twatchChildEvent,\n\t\tgetSelection,\n\t\ttransferStyles,\n\t\tmeasureString,\n\t\tautoGrow,\n\t\tdomToString,\n\t\tlogError\n\t};\n});\n"]}